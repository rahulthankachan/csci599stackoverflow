__author__ = 'Prathmesh'

import xlsxwriter

workbook = xlsxwriter.Workbook('Output/charts/answercount_comparision.xlsx')
worksheet = workbook.add_worksheet()
bold = workbook.add_format({'bold': 1})

# Add the worksheet data that the charts will refer to.
headings = ['javascript', 'java', 'c#','php','python','html','c++','sql','objective-c','c']
data = [
    [0, 588, 2661, 2450, 1696, 1702, 2463, 2763, 2666, 2753, 3955, 3995, 4384, 4624, 4072, 4741, 5391, 5677, 5966, 5733, 6352, 6210, 6601, 6706, 7922, 7852, 7991, 8088, 9343, 9834, 10984, 10791, 13522, 13613, 14093, 15221, 16057, 17670, 15250, 14369, 16302, 15698, 17833, 18103, 19421, 18839, 20239, 19624, 20680, 21810, 19351, 21724, 20917, 19705, 22640, 22174, 24793, 24637, 24081, 23410, 27174, 27076, 28451, 32520, 29909, 30304, 35488, 34521, 35616, 33535, 30377, 27436, 30522, 28388, 27505, 28427, 27514, 26725, 27810, 28424, 30591, 33843, 34325, 35134, 37011, 16926],
    [0, 794, 4922, 4192, 3109, 3037, 4213, 4520, 4694, 4884, 6150, 6719, 6993, 6306, 6393, 7049, 8532, 8173, 10526, 9170, 11513, 9728, 10682, 10312, 10604, 11248, 10825, 11725, 12884, 13183, 15257, 15809, 19201, 17564, 18382, 17474, 17783, 18592, 17806, 17812, 20101, 19543, 21503, 22499, 24714, 23515, 24007, 21766, 23817, 24716, 22720, 27130, 25499, 24497, 26596, 26027, 29919, 30036, 28070, 25909, 28131, 28998, 29892, 34700, 34005, 31938, 33098, 33597, 36463, 33692, 28236, 25114, 27931, 25467, 27034, 28930, 28106, 26466, 26375, 26039, 30191, 31777, 29548, 27782, 28772, 12879],
    [2, 2128, 7239, 7341, 5645, 5540, 8091, 8466, 10133, 10536, 10895, 11850, 13075, 12702, 11853, 13137, 13189, 12840, 13660, 13452, 15522, 14339, 14448, 15165, 16232, 16690, 15452, 15847, 17552, 16938, 18703, 18770, 23253, 20950, 22412, 22042, 21133, 21848, 19690, 19645, 21202, 19726, 22433, 22125, 23601, 21967, 22899, 21546, 24298, 23374, 21198, 23970, 22379, 20105, 23740, 22678, 25928, 24339, 23927, 22155, 24929, 24380, 23259, 25914, 24404, 23139, 26187, 24999, 26006, 23804, 21465, 18824, 20465, 18609, 18371, 18103, 16925, 16490, 16950, 16932, 18699, 19596, 19373, 19561, 20951, 9364],
    [0, 678, 2295, 2371, 1659, 1665, 2265, 2790, 3029, 3094, 3761, 4675, 6012, 6337, 6155, 6351, 7613, 7889, 9226, 8187, 9148, 8795, 9699, 9717, 11093, 12134, 10972, 10157, 11943, 12623, 14670, 14757, 18461, 17338, 18058, 18137, 19068, 19317, 16648, 16405, 18141, 17112, 19356, 20171, 22026, 20416, 21699, 20472, 22684, 22319, 21212, 23101, 22410, 20975, 24000, 22875, 26193, 25223, 23858, 22809, 25732, 25440, 23187, 23238, 22879, 22513, 26003, 24958, 26454, 25271, 20922, 17950, 20356, 18595, 18952, 18936, 18010, 17732, 19349, 17988, 19281, 20339, 19265, 19130, 20105, 9208],
    [0, 474, 2275, 1896, 1495, 1505, 2094, 2127, 2479, 2258, 3004, 3154, 3338, 3125, 3219, 3882, 4305, 4409, 5041, 4382, 4981, 4248, 4230, 4646, 5720, 5566, 4651, 5768, 5793, 5549, 6190, 6266, 7881, 6850, 7078, 6985, 7209, 7733, 6880, 6917, 7324, 7067, 8421, 8620, 9700, 9052, 9461, 9729, 10520, 10630, 9467, 11032, 11104, 10063, 11285, 11234, 12750, 13213, 13012, 12528, 14304, 13310, 12953, 15446, 15635, 13986, 15714, 15460, 17351, 16020, 13546, 12743, 14749, 13417, 12909, 13915, 14559, 13711, 14640, 14949, 16801, 17407, 17448, 17241, 18272, 7861],
    [0, 329, 1149, 860, 752, 667, 1046, 1139, 1116, 1038, 1265, 1575, 1911, 1758, 1637, 1580, 1790, 1906, 2226, 1980, 2116, 1813, 2053, 2305, 2748, 2575, 2427, 2472, 2847, 2964, 3413, 3269, 4263, 3908, 4102, 4394, 4502, 4760, 4317, 4306, 4461, 4525, 5040, 5384, 5366, 5389, 5516, 5655, 6382, 6668, 5738, 6216, 6071, 5928, 6776, 6397, 7834, 7769, 7598, 7551, 8684, 9096, 8707, 8746, 7920, 8636, 10141, 9064, 9825, 9195, 8646, 7573, 8559, 7790, 7545, 7486, 7205, 6823, 7426, 7414, 7827, 8314, 8261, 8407, 8456, 4190],
    [0, 635, 4345, 3878, 3042, 2647, 3354, 3657, 4461, 4105, 4644, 4799, 5371, 4939, 5090, 5886, 5897, 6160, 6722, 7328, 7275, 7386, 6934, 8093, 7760, 7723, 7767, 8172, 9306, 8503, 9724, 8728, 10609, 10144, 9608, 9605, 9692, 9746, 9642, 10010, 10219, 9590, 10024, 11076, 11029, 10463, 9609, 9115, 10354, 10675, 9651, 11674, 11705, 10688, 11469, 11337, 13395, 12908, 12215, 11200, 11883, 11783, 11720, 13590, 13852, 12052, 13178, 12908, 14062, 13209, 10669, 8741, 9840, 9200, 9676, 10615, 10039, 9536, 9308, 9728, 10780, 10792, 10317, 9921, 10414, 4401],
    [0, 599, 2558, 2090, 1361, 1508, 2025, 2349, 2170, 2203, 2675, 2905, 3025, 2700, 3533, 3742, 3345, 3119, 2962, 2962, 3336, 2927, 3121, 3475, 4036, 3880, 3553, 3722, 4175, 3579, 4569, 4004, 4947, 4265, 4858, 5222, 4878, 4794, 4529, 4562, 4933, 4528, 4922, 5374, 6086, 5476, 5697, 5247, 5885, 6124, 6099, 6657, 6654, 6000, 7357, 7269, 7914, 7641, 7364, 6835, 8194, 7841, 7967, 9160, 8453, 8186, 9152, 8900, 9424, 9371, 8390, 7896, 8390, 8008, 7852, 7186, 6297, 6147, 6313, 6174, 6954, 7088, 6847, 7080, 7193, 3143],
    [0, 46, 146, 307, 282, 342, 323, 478, 621, 746, 1071, 1139, 1419, 1423, 1352, 1507, 1508, 1612, 2016, 1780, 1918, 1973, 2126, 2264, 3144, 3043, 2702, 2924, 3217, 3280, 3952, 4271, 5340, 5825, 6099, 5781, 6434, 6830, 5853, 5515, 6175, 5822, 6595, 6811, 6681, 6602, 6722, 6570, 7022, 7179, 5677, 6840, 6497, 6485, 7128, 6651, 7867, 7023, 6947, 5742, 6329, 5950, 6329, 7482, 6436, 6686, 7632, 7800, 8103, 7274, 6435, 5206, 6077, 5306, 5233, 5253, 4712, 4667, 4606, 4740, 5146, 5478, 5224, 4883, 5233, 2323],
    [0, 262, 1240, 946, 735, 545, 1112, 1159, 1335, 1396, 1389, 1595, 1651, 1671, 1720, 2272, 3046, 2400, 2699, 2693, 2695, 2781, 2590, 2678, 3097, 3296, 3236, 3460, 3768, 3032, 2957, 3480, 4348, 4183, 3751, 3340, 3340, 3743, 3939, 4197, 4440, 3934, 4466, 4524, 5105, 4722, 4212, 4241, 4311, 4229, 4660, 5740, 5622, 4640, 5157, 5231, 6073, 5837, 5542, 5228, 5365, 5553, 5864, 7187, 6748, 5802, 6333, 6547, 7319, 6161, 4701, 4047, 4389, 4433, 4986, 5914, 5458, 5212, 5041, 5084, 5790, 6061, 5393, 5022, 4830, 2055],
    [2008, ' ', ' ', ' ', ' ', ' ',2009, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',2010, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',2011, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 2012, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',2013, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',2014, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',2015, ' ', ' ', ' ', ' ', ' ', ' ']
]

worksheet.write_row('A1', headings, bold)
worksheet.write_column('A2', data[0])
worksheet.write_column('B2', data[1])
worksheet.write_column('C2', data[2])
worksheet.write_column('D2', data[3])
worksheet.write_column('E2', data[4])
worksheet.write_column('F2', data[5])
worksheet.write_column('G2', data[6])
worksheet.write_column('H2', data[7])
worksheet.write_column('I2', data[8])
worksheet.write_column('J2', data[9])
worksheet.write_column('K2', data[10])



# Create a new chart object. In this case an embedded chart.
chart1 = workbook.add_chart({'type': 'line'})

# Configure the first series.
chart1.add_series({
    'name':       '=Sheet1!$A$1',
    'categories': '=Sheet1!$K$2:$K$87',
    'values':     '=Sheet1!$A$2:$A$87',
})

# Configure second series. Note use of alternative syntax to define ranges.
chart1.add_series({
    'name':       '=Sheet1!$B$1',
    'categories': '=Sheet1!$K$2:$K$87',
    'values':     '=Sheet1!$B$2:$B$87',
})


chart1.add_series({
    'name':       '=Sheet1!$C$1',
    'categories': '=Sheet1!$K$2:$K$87',
    'values':     '=Sheet1!$C$2:$C$87',
})


chart1.add_series({
    'name':       '=Sheet1!$D$1',
    'categories': '=Sheet1!$K$2:$K$87',
    'values':     '=Sheet1!$D$2:$D$87',
})

chart1.add_series({
    'name':       '=Sheet1!$E$1',
    'categories': '=Sheet1!$K$2:$K$87',
    'values':     '=Sheet1!$E$2:$E$87',
})

chart1.add_series({
    'name':       '=Sheet1!$F$1',
    'categories': '=Sheet1!$K$2:$K$87',
    'values':     '=Sheet1!$F$2:$F$87',
})

chart1.add_series({
    'name':       '=Sheet1!$G$1',
    'categories': '=Sheet1!$K$2:$K$87',
    'values':     '=Sheet1!$G$2:$G$87',
})

chart1.add_series({
    'name':       '=Sheet1!$H$1',
    'categories': '=Sheet1!$K$2:$K$87',
    'values':     '=Sheet1!$H$2:$H$87',
})

chart1.add_series({
    'name':       '=Sheet1!$I$1',
    'categories': '=Sheet1!$K$2:$K$87',
    'values':     '=Sheet1!$I$2:$I$87',
})

chart1.add_series({
    'name':       '=Sheet1!$J$1',
    'categories': '=Sheet1!$K$2:$K$87',
    'values':     '=Sheet1!$J$2:$J$87',
})

# Add a chart title and some axis labels.
#chart1.set_title ({'name': 'Duration Analysis'})
chart1.set_x_axis({'name': 'Duration'})
chart1.set_y_axis({'name': 'Answer Count'})

# Set an Excel chart style. Colors with white outline and shadow.
chart1.set_style(10)

# Insert the chart into the worksheet (with an offset).
worksheet.insert_chart('D2', chart1, {'x_offset': 25, 'y_offset': 10})


workbook.close()

